<div class="beer-container">

  <!-- Font awesome back button -->
  <div class="back-button">
    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
      viewBox="0 0 492 492" width="25px" fill="#fcfcfc" style="enable-background:new 0 0 492 492;" xml:space="preserve">
      <g>
        <g>
          <path d="M198.608,246.104L382.664,62.04c5.068-5.056,7.856-11.816,7.856-19.024c0-7.212-2.788-13.968-7.856-19.032l-16.128-16.12
            C361.476,2.792,354.712,0,347.504,0s-13.964,2.792-19.028,7.864L109.328,227.008c-5.084,5.08-7.868,11.868-7.848,19.084
            c-0.02,7.248,2.76,14.028,7.848,19.112l218.944,218.932c5.064,5.072,11.82,7.864,19.032,7.864c7.208,0,13.964-2.792,19.032-7.864
            l16.124-16.12c10.492-10.492,10.492-27.572,0-38.06L198.608,246.104z"/>
        </g>
      </g>
    </svg>
  </div>

  <!-- Beer image -->

  <div class="list-unstyled beer-info-top">
    <% if @beer.photo.attached? %>
     <%= cl_image_tag @beer.photo.key, height: 400, width: 400, crop: :fit %>
    <% else %>
      <%= image_tag "https://media-cdn.tripadvisor.com/media/photo-s/16/25/81/c2/our-new-logo.jpg", class: "img-fluid" %>
      <% end %>
  </div>

  <!-- Add and check icons -->

  <div class = "check-plus-buttons">
    <% @to_drink = UsersBeer.find_by(beer: @beer, user: current_user, drank: :false) %>
    <% @drank = UsersBeer.find_by(beer: @beer, user: current_user, drank: :true) %>
    <% if @to_drink %>
    <%= link_to unlist_beer_path, method: :delete do %>
      <div class="plus-button-gray">
        <svg viewBox="0 0 448 448" width="25px" fill="#666666" xmlns="http://www.w3.org/2000/svg"><path d="m408 184h-136c-4.417969 0-8-3.582031-8-8v-136c0-22.089844-17.910156-40-40-40s-40 17.910156-40 40v136c0 4.417969-3.582031 8-8 8h-136c-22.089844 0-40 17.910156-40 40s17.910156 40 40 40h136c4.417969 0 8 3.582031 8 8v136c0 22.089844 17.910156 40 40 40s40-17.910156 40-40v-136c0-4.417969 3.582031-8 8-8h136c22.089844 0 40-17.910156 40-40s-17.910156-40-40-40zm0 0"/></svg>
      </div>
      <% end %>
      <%= link_to drank_beer_path, method: :post do %>
      <div class="check-button">
        <svg viewBox="0 -46 417.81333 417" width="25px" fill="#fcfcfc" xmlns="http://www.w3.org/2000/svg"><path d="m159.988281 318.582031c-3.988281 4.011719-9.429687 6.25-15.082031 6.25s-11.09375-2.238281-15.082031-6.25l-120.449219-120.46875c-12.5-12.5-12.5-32.769531 0-45.246093l15.082031-15.085938c12.503907-12.5 32.75-12.5 45.25 0l75.199219 75.203125 203.199219-203.203125c12.503906-12.5 32.769531-12.5 45.25 0l15.082031 15.085938c12.5 12.5 12.5 32.765624 0 45.246093zm0 0"/></svg>
      </div>
      <% end %>
  
    <% elsif @drank %>
      <%= link_to to_drink_beer_path, method: :post do %>
      <div class="plus-button">
        <svg viewBox="0 0 448 448" width="25px" fill="#fcfcfc" xmlns="http://www.w3.org/2000/svg"><path d="m408 184h-136c-4.417969 0-8-3.582031-8-8v-136c0-22.089844-17.910156-40-40-40s-40 17.910156-40 40v136c0 4.417969-3.582031 8-8 8h-136c-22.089844 0-40 17.910156-40 40s17.910156 40 40 40h136c4.417969 0 8 3.582031 8 8v136c0 22.089844 17.910156 40 40 40s40-17.910156 40-40v-136c0-4.417969 3.582031-8 8-8h136c22.089844 0 40-17.910156 40-40s-17.910156-40-40-40zm0 0"/></svg>
      </div>
      <% end %>
      <%= link_to unlist_beer_path, method: :delete do %>
      <div class="check-button-gray">
        <svg viewBox="0 -46 417.81333 417" width="25px" fill="#666666" xmlns="http://www.w3.org/2000/svg"><path d="m159.988281 318.582031c-3.988281 4.011719-9.429687 6.25-15.082031 6.25s-11.09375-2.238281-15.082031-6.25l-120.449219-120.46875c-12.5-12.5-12.5-32.769531 0-45.246093l15.082031-15.085938c12.503907-12.5 32.75-12.5 45.25 0l75.199219 75.203125 203.199219-203.203125c12.503906-12.5 32.769531-12.5 45.25 0l15.082031 15.085938c12.5 12.5 12.5 32.765624 0 45.246093zm0 0"/></svg>
      </div>
      <% end %>
    
    <% else %>
      <%= link_to to_drink_beer_path, method: :post do %>
      <div class="plus-button">
        <svg viewBox="0 0 448 448" width="25px" fill="#fcfcfc" xmlns="http://www.w3.org/2000/svg"><path d="m408 184h-136c-4.417969 0-8-3.582031-8-8v-136c0-22.089844-17.910156-40-40-40s-40 17.910156-40 40v136c0 4.417969-3.582031 8-8 8h-136c-22.089844 0-40 17.910156-40 40s17.910156 40 40 40h136c4.417969 0 8 3.582031 8 8v136c0 22.089844 17.910156 40 40 40s40-17.910156 40-40v-136c0-4.417969 3.582031-8 8-8h136c22.089844 0 40-17.910156 40-40s-17.910156-40-40-40zm0 0"/></svg>
      </div>
      <% end %>

      <%= link_to drank_beer_path, method: :post do %>
      <div class="check-button">
        <svg viewBox="0 -46 417.81333 417" width="25px" fill="#fcfcfc" xmlns="http://www.w3.org/2000/svg"><path d="m159.988281 318.582031c-3.988281 4.011719-9.429687 6.25-15.082031 6.25s-11.09375-2.238281-15.082031-6.25l-120.449219-120.46875c-12.5-12.5-12.5-32.769531 0-45.246093l15.082031-15.085938c12.503907-12.5 32.75-12.5 45.25 0l75.199219 75.203125 203.199219-203.203125c12.503906-12.5 32.769531-12.5 45.25 0l15.082031 15.085938c12.5 12.5 12.5 32.765624 0 45.246093zm0 0"/></svg>
      </div>
      <% end %>

    <% end %>
  </div>

  <!-- Beer details -->
  
  <div class="container">
    <div class="container-fluid beer">
     <div class="beer-name-stars">
        <h1 class="beer-name"><%= @beer.name %></h1>
        <% if current_user.reviews.where(beer_id: @beer) == [] %>
        <!-- button to open modal-->
          <button type="button" class="btn btn-sm rev" data-toggle="modal" data-target="#modal">
            <% 5.times do %>
              <i class="fas fa-star gray"></i>
            <% end %>
          </button>

        <% else %>
          <p class="beer-stars">
            <% current_user.reviews.where(beer_id: @beer).last.rating.times do%>
            <i class="fas fa-star"></i>
            <% end %>
            <% (5 - current_user.reviews.where(beer_id: @beer).last.rating).times do%>
            <i class="far fa-star"></i>
            <% end %> 
          </p>
        <% end %>
      </div>
      <div class="category-brewery">
        <p class="beer-category"><%= @beer.category %></p>
  <!--  <p class="beer-brewery">Musa</p> -->
      </div>
      <p class="beer-description"><%= @beer.description %></p>
    </div>
  </div>

  <div class="beer-infos">
    <p><%= @beer.alcohol %>%</p>
    <p><%= @beer.ibu %> IBU</p>
    <p><%= @beer.avg_rating %></p>
  </div>
</div>
<div class="container">
  <div class="container-fluid">
    <div class="beer-menu">
      <button class="button beer-menu"> <%= link_to "check which bars sell this beer", bar_list_beer_path(@beer) %> </button>
    </div>
  </div>
</div>

<div class="beer-show-line"></div>

<!-- Reviews -->
<div class="container">
  <div class="container-fluid">
    <div class="beer-reviews">
      <p>Reviews:</p>
      <ul class="list-group">
        <% @beer.reviews.order('updated_at DESC').each do |review| %>
          <div class="review-show-line"></div>
          <li class="list-group-item review-content">
            <p><%= review.user.first_name %></p>
            <% review.rating.times do%>
              <i class="fas fa-star"></i>
              <% end %>
              <% (5 - review.rating).times do%>
              <i class="far fa-star"></i>
              <% end %>
            <p><%= review.content %></p>
          </li>
        <% end %>
      </ul>
    </div>
  </div>
</div>

<!-- Review Modal -->
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <!-- <h4 class="modal-title">Review</h4> -->
      </div>
      <div class="modal-body">
        <div class="form-group">
          <%= simple_form_for [ @beer, @review ] do |f| %>
          <div class="rate-title">Rate it:</div>
          <div class="rate">
            <input type="radio" id="star5" name="review[rating]" value="5" <%= @review.rating == 5 ? "checked" : "" %> />
            <label for="star5" title="text">5 stars</label>
            <input type="radio" id="star4" name="review[rating]" value="4" <%= @review.rating == 4 ? "checked" : "" %>/>
            <label for="star4" title="text">4 stars</label>
            <input type="radio" id="star3" name="review[rating]" value="3" <%= @review.rating == 3 ? "checked" : "" %>/>
            <label for="star3" title="text">3 stars</label>
            <input type="radio" id="star2" name="review[rating]" value="2" <%= @review.rating == 2 ? "checked" : "" %>/>
            <label for="star2" title="text">2 stars</label>
            <input type="radio" id="star1" name="review[rating]" value="1" <%= @review.rating == 1 ? "checked" : "" %> />
            <label for="star1" title="text">1 star</label>
          </div>
        </div>
        <div class="review-title-container">
          <label for="review-title">Leave a review:</label>
            <%= f.input :content, label: false, placeholder: 'Your opinion here' %>
            <%= f.submit "Submit review", class: "btn btn-primary review" %>
          <% end %>
        </div>
      </div>
    </div>

  </div>
</div>
<!-- End of Review Modal -->
